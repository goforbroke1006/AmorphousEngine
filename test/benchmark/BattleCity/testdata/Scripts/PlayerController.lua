---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by goforbroke.
--- DateTime: 12/29/23 2:44 PM
---

require "Core/LuaBehaviour"

-- TODO: invoke "= LuaBehaviour:new()" under the hood
PlayerController = LuaBehaviour:new()

function PlayerController:Awake()
    self.tank = self:GetComponent(Tank)
    if self.tank == nil then
        Debug.LogWarning("Player: '" .. self.gameObject.name .. "' is not a tank")
    end
end

function PlayerController:Start()

end

function PlayerController:Update()
    if self.tank == nil then
        return
    end

    if Input.GetButtonDown("Fire1") then
        Debug.Log("Fire!!!")

        self.tank:TryMakeAShot()
    end

    local verSpeed = Input.GetAxis("Vertical");
    local horSpeed = Input.GetAxis("Horizontal");

    if verSpeed ~= 0.0 then
        if verSpeed > 0 then
            self.transform.rotation = Quaternion.Euler(0, 0, 0);
        end
        if verSpeed < 0 then
            self.transform.rotation = Quaternion.Euler(0, -180, 0);
        end

        self.tank:DriveStraight(verSpeed)
    else
        if horSpeed ~= 0.0 then
            if horSpeed > 0 then
                self.transform.rotation = Quaternion.Euler(0, 90, 0);
            end
            if horSpeed < 0 then
                self.transform.rotation = Quaternion.Euler(0, -90, 0);
            end

            self.tank:DriveStraight(horSpeed)
        end
    end
end
